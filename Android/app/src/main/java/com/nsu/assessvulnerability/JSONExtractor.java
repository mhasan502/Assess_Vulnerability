package com.nsu.assessvulnerability;

import android.util.Log;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.util.ArrayList;
import java.util.List;


class JSONExtractor {
    SurveyBuilder[] surveyBuilder;
    public JSONExtractor(JSONArray jsonArray) throws JSONException {
        initializeSurveyBuilder(jsonArray.length());
        for (int i = 0; i < jsonArray.length(); i++) {
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            String question = jsonObject.get("label").toString();
            String fieldType = jsonObject.get("field_type").toString();
            String stringRequired = jsonObject.get("required").toString();
            boolean required = Boolean.parseBoolean(stringRequired);

            JSONArray fieldOptions = jsonObject.getJSONObject("field_options").getJSONArray("options");
            List<SurveyOptions> list = new ArrayList<>();

            for (int j = 0; j < fieldOptions.length(); j++) {
                JSONObject object = fieldOptions.getJSONObject(j);
                String optionLabel = object.get("label").toString();
                String optionStringRequired = jsonObject.get("required").toString();
                boolean optionRequired = Boolean.parseBoolean(optionStringRequired);
                list.add(new SurveyOptions(optionLabel, optionRequired));
            }
            surveyBuilder[i] = new SurveyBuilder(question, fieldType, required, list);
            System.out.println(surveyBuilder[i]);
        }

    }
    void initializeSurveyBuilder(int length){
         surveyBuilder = new SurveyBuilder[length];
    }
    SurveyBuilder[] build(){
        return surveyBuilder;
    }
}