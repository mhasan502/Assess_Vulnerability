package com.nsu.assessvulnerability;

import android.util.Log;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.util.ArrayList;


class JSONExtractor {
    SurveyBuilder[] surveyBuilder;
    public JSONExtractor(JSONArray jsonArray) throws JSONException {
        initializeSurveyBuilder(jsonArray.length());
        for (int i = 0; i < jsonArray.length(); i++) {
            JSONObject jsonObject = jsonArray.getJSONObject(i);
            String label = jsonObject.get("label").toString();
            String fieldType = jsonObject.get("field_type").toString();
            String stringRequired = jsonObject.get("required").toString();
            boolean required = Boolean.parseBoolean(stringRequired);

            JSONArray fieldOptions = jsonObject.getJSONObject("field_options").getJSONArray("options");
            ArrayList<SurveyOption> arrayList = new ArrayList<>();
            for (int j = 0; j < fieldOptions.length(); j++) {
                JSONObject object = jsonArray.getJSONObject(i);
                String optionLabel = object.get("label").toString();
                String optionStringRequired = jsonObject.get("required").toString();
                boolean optionRequired = Boolean.parseBoolean(optionStringRequired);
                arrayList.add(new SurveyOption(optionLabel,optionRequired));
            }
            surveyBuilder[i] = new SurveyBuilder(label, fieldType, required, arrayList);
        }

    }
    void initializeSurveyBuilder(int length){
         surveyBuilder = new SurveyBuilder[length];
    }
    SurveyBuilder[] build(){
        return surveyBuilder;
    }
}