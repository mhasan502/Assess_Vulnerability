import json
from django.utils.safestring import SafeString

from django.http import HttpResponse
from django.shortcuts import render
from survey.models import Questions


def SurveyView(request):
    return render(request, 'survey.html')


def CreateSurvey(request):
    return render(request, 'create_survey.html')


def EditSurvey(request):
    query = Questions.objects.get(id=1)
    json_data = json.dumps(query.json)
    data = {
        'query': json_data,
        'token': json.dumps(query.token),
    }
    return render(request, 'edit_survey.html', data)


def SaveSurvey(request):
    data = request.POST.get('data')
    # data = json.loads(data)
    token = request.POST.get('token')
    print("Here")
    # try:
    #     check_if_exists = Questions.objects.get(token=token)
    #     check_if_exists.json = data
    #     check_if_exists.save(update_fields=['json'])
    #     print('saved')
    #
    # except Exception:
    #     questions = Questions.objects.create(json=data, token=token)
    #     questions.save()

    return HttpResponse('')
